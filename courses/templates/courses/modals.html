{% load static %}
<!-- Add Topic -->
<div class="modal fade" id="topicModal" tabindex="-1" aria-labelledby="topicModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="topicModalLabel">Add Topic</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="topic-create-form" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-body px-4">
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold">Topic Name</label>
            <input type="text" name="title" id="title" class="form-control p-3 mb-2" placeholder="Topic Name"
              required />
            <small class="text-muted">
              <i class="fal fa-info-circle"></i> Topic titles are displayed
              publicly wherever required. Each topic may contain one or more
              lessons, quiz and assignments.
            </small>
          </div>

          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold">Topic Summary</label>
            <textarea name="summary" class="form-control p-3 mb-2" rows="3" id="summary"></textarea>
            <small class="text-muted" required>
              <i class="fal fa-info-circle"></i> Add a summary of short text to
              prepare students for the activities for the topic. The text is
              shown on the course page beside the tooltip beside the topic name.
            </small>
          </div>
        </div>
        <div class="modal-footer d-flex justify-content-between">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            Close
          </button>
          <button type="submit" class="btn btn-primary">Create Topic</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Edit Topic -->
<div class="modal fade" id="updateTopicModal" tabindex="-1" aria-labelledby="updateTopicModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="updateTopicModalLabel">
          Edit Topic
        </h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="updateTopicForm" method="POST">
        <input class="d-none" type="text" name="topicId" />
        <input class="d-none" type="text" name="sort_order" />

        <div class="modal-body px-4">
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold">Topic Name</label>
            <input type="text" name="title" class="form-control p-3 mb-2" placeholder="Topic Name" required />
            <small class="text-muted">
              <i class="fal fa-info-circle"></i> Topic titles are displayed
              publicly wherever required. Each topic may contain one or more
              lessons, quiz and assignments.
            </small>
          </div>

          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold">Topic Summary</label>
            <textarea name="summary" class="form-control p-3 mb-2" rows="3"></textarea>
            <small class="text-muted" required>
              <i class="fal fa-info-circle"></i> Add a summary of short text
              to prepare students for the activities for the topic. The text
              is shown on the course page beside the tooltip beside the
              topic name.
            </small>
          </div>
        </div>
        <div class="modal-footer d-flex justify-content-between">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            Close
          </button>
          <button id="saveUpdateTopic" type="submit" class="btn btn-primary">
            Save Topic
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Style for quiz modals -->
<style>
  .form-progress {
    position: relative;
    display: block;
    margin: 0px auto 30px auto;
    width: 100%;
    max-width: 660px;
  }

  progress {
    display: block;
    position: relative;
    top: 5px;
    left: 0px;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background: #0071dc;
    width: 100%;
    height: 2px;
    background: none;
    transition: 1s;
    will-change: contents;
  }

  progress::-webkit-progress-bar {
    background-color: #e3e5eb;
  }

  progress::-webkit-progress-bar::after {
    background-color: #0071dc;

  }

  progress::-webkit-progress-value {
    background-color: #0071dc;
    -webkit-transition: all 0.5s ease-in-out;
    transition: all 0.5s ease-in-out;
  }

  .form-progress-indicator {
    position: absolute;
    top: -6px;
    left: 0;
    display: inline-block;
    width: 25px;
    height: 25px;
    background: white;
    border: 3px solid #e3e5eb;
    border-radius: 50%;
    transition: all 0.2s ease-in-out;
    transition-delay: 0.3s;
    will-change: transform;
    font-size: 13px;
  }

  .form-progress-indicator.one {
    left: 0;
  }

  .form-progress-indicator.two {
    left: 50%;
  }

  .form-progress-indicator.three {
    left: 100%;
  }

  .form-progress-indicator.active {
    -webkit-animation: bounce 0.5s forwards;
    animation: bounce 0.5s forwards;
    -webkit-animation-delay: 0.5s;
    animation-delay: 0.5s;
    border-color: #0071dc;
    background-color: #0071dc;
    color: white;
  }

  /* Styles for the slider container and progress bar */
  .slider-container {
    width: 100%;
    margin: 0 auto;
    text-align: center;
    position: relative;
  }

  .rangePercentage {
    position: relative;
    width: 50px;
    height: 30px;
    background-color: #0071dc;
    color: white;
  }

  .arrow {
    position: absolute;
    top: 0;
    left: -15px;
    width: 0;
    height: 0;
    border-top: 15px solid transparent;
    border-bottom: 15px solid transparent;
    border-right: 15px solid #0071dc;
  }

  .questionTypeJS:hover {
    border-radius: 5px;
    box-shadow: 0px 7px 29px 0px rgba(129, 129, 139, 0.2);
  }

  .optionImage {
    width: 30px;
    height: 30px;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border-radius: 5px;
  }
</style>

<!-- quiz Modal Step1 -->
<div class="modal fade" id="quizModalStep1" tabindex="-1" aria-labelledby="quizModalStep1Label" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="quizModalStep1Label">Quiz</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-5">
        <div class="mb-5">
          <div class="form-progress">
            <progress class="form-progress-bar" min="0" max="100" value="0" step="33"
              aria-labelledby="form-progress-completion"></progress>

            <div class="justify-content-center d-flex align-items-center form-progress-indicator one active">1</div>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator two">2</div>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator three">3</div>

            <p id="form-progress-completion" class="js-form-progress-completion sr-only" aria-live="polite">0% complete
            </p>
          </div>
        </div>
        <div>
          <form id="quizFormStep1">
            <div class="form-outline mb-3">
              <label class="form-label my-2 fw-bold">Quiz Title</label>
              <input id="quiz-title" type="text" style="background-color: #f8f8f8;" name="title" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
            </div>
            <div class="form-outline mb-3">
              <label class="form-label my-2 fw-bold">Summary</label>
              <textarea id="quiz-summary" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0" rows="10"
              placeholder="Summary"></textarea>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Close</button>
        <button id="save-quiz-step1" type="submit" class="btn btn-primary" form="quizFormStep1">Save &
          Next</button>
      </div>
    </div>
  </div>
</div>

<!-- quiz Modal Step2 -->
<div class="modal fade" id="quizModalStep2" tabindex="-1" aria-labelledby="quizModalStep1Label" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="quizModalStep1Label">Quiz</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-5">
        <div class="mb-5">
          <div class="form-progress">
            <progress class="form-progress-bar" min="0" max="100" value="50" step="33"
              aria-labelledby="form-progress-completion"></progress>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator one active">1</div>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator two active">2</div>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator three">3</div>
            <p id="form-progress-completion" class="js-form-progress-completion sr-only" aria-live="polite">0% complete
            </p>
          </div>
        </div>
        <div id="quiz-questions-container"></div>
        <button id="quiz-add-question-btn" type="button" class="btn btn-outline-primary p-3 mb-5" data-bs-toggle="modal"
          data-bs-target="#questionModal">
          <i class="fas fa-plus-square"></i>
          <span>&nbsp;&nbsp;Add Question</span>
        </button>
      </div>
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Close</button>
        <div class="d-flex gap-3">
          <button id="back-quiz-step2" type="button" data-bs-toggle="modal" data-bs-target="#quizModalStep1"
            class="btn btn-outline-primary">Back</button>
          <button id="save-quiz-step2" type="button" data-bs-toggle="modal" data-bs-target="#quizModalStep3" class="btn btn-primary">Save &
            Next</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- question Modal -->
<div class="modal fade" id="questionModal" tabindex="-1" aria-labelledby="questionModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
    <div class="modal-content p-0">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="questionModalLabel">Quiz</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-0">
        <div class="p-5 pb-0">
          <div class="mb-5">
            <div class="form-progress">
              <progress class="form-progress-bar" min="0" max="100" value="50" step="33"
                aria-labelledby="form-progress-completion"></progress>
              <div class="justify-content-center d-flex align-items-center form-progress-indicator one active">1</div>
              <div class="justify-content-center d-flex align-items-center form-progress-indicator two active">2</div>
              <div class="justify-content-center d-flex align-items-center form-progress-indicator three">3</div>
              <p id="form-progress-completion" class="js-form-progress-completion sr-only" aria-live="polite">0%
                complete
              </p>
            </div>
          </div>
          <div>
            <form id="questionForm">
            <div class="form-outline mb-4">
              <label class="form-label my-2 fw-bold">Write your question here</label>
              <input id="question-title" type="text" style="background-color: #f8f8f8;" name="title" class="form-control p-3 mb-2 border-0"
                placeholder="Write your question here" required />
            </div>
            <div class="mb-5">
              <label class="form-label my-2 fw-bold">Select your question type</label>
              <div class="card bg-white text-start mb-3">
                <div class="card-body p-0">
                  <div class="section px-2 py-3 d-flex align-items-center justify-content-between"
                    data-bs-toggle="collapse" href="#questionTypeSelect" style="cursor: pointer;">

                    <div id="selectedTypeJS" data-bs-toggle="collapse" href="#questionTypeSelect" style="width: 200px; cursor: pointer;" data-question-type="TF">
                      <div class="d-flex gap-3 align-items-center">
                        <button class="btn btn-outline-primary border rounded" type="button"
                          style="background-color:#3e64de; color: white;" aria-expanded="false">
                          <i class="far fa-adjust"></i>
                        </button>
                        <small class="fw-bold text-muted">True / False</small>
                      </div>
                    </div>

                    <span class="d-flex gap-2 px-2">
                      <button type="button" class="btn btn-sm"><i class="fas fa-chevron-down text-muted"></i></button>
                    </span>
                  </div>
                  <div class="collapse" id="questionTypeSelect">
                    <div class="card card-body">
                      <div class="row">

                        <div class="d-flex flex-wrap gap-3" id="questionTypesContainer"></div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="d-flex gap-3 mb-4">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="question-answer_required">
                <label class="form-check-label" for="question-answer_required">Answer Required</label>
              </div>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="randomize_options">
                <label class="form-check-label" for="randomize_options">Randomize</label>
              </div>
            </div>
            <div class="mb-4">
              <label class="form-label my-2 fw-bold">Point(s) for this answer</label>
              <div class="d-flex gap-3 align-items-center">
                <input id="question-points" type="text" style="width: 200px; background-color: #f8f8f8;"
                  class="form-control p-3 mb-2 border-0" placeholder="Set the mark" required />
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch" id="question-display_points">
                  <label class="form-check-label" for="question-display_points">Display Points</label>
                </div>
              </div>
              <small>Time limit for this quiz. 0 means no time limit.</small>
            </div>
            <label class="form-label my-2 mb-4 fw-bold">Description (Optional)</label>
            <br>
            <label class="form-label my-2 mb-4 fw-bold">Input options for the question and select the correct
              answer.</label>
            </form>
          </div>
        </div>
        <div id="typeOptionsJS">
          <div class="p-5" id="optionform_true_/_false" style="background: #e3e5eb;">
            <div class="bg-white border mb-3 p-3 rounded d-flex align-items-center justify-content-between">
              <small>
                True
              </small>
              <span class="d-flex gap-2 align-items-center">
                <div class="form-check">
                  <input id="option-TF-true" class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="radio"
                    name="trueFalse" value="true">
                </div>
                <span class="fs-6 SortHandle" style="cursor: grab;">
                  <i class="fal fa-grip-vertical text-muted mx-2"></i>
                </span>
              </span>
            </div>
            <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between">
              <small>
                False
              </small>
              <span class="d-flex gap-2 align-items-center">
                <div class="form-check">
                  <input id="option-TF-false" class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="radio"
                    name="trueFalse" value="false">
                </div>
                <span class="fs-6 SortHandle" style="cursor: grab;">
                  <i class="fal fa-grip-vertical text-muted mx-2"></i>
                </span>
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Close</button>
        <button id="save-question-btn" type="submit" class="btn btn-primary" form="questionForm">Save &
          Next</button>
      </div>
    </div>
  </div>
</div>

<!-- quiz Modal Step3 -->
<div class="modal fade" id="quizModalStep3" tabindex="-1" aria-labelledby="quizModalStep1Label" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
    <div class=" mb-3">
    </div>
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="quizModalStep1Label">Quiz</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-5">
        <div class="mb-5">
          <div class="form-progress">
            <progress class="form-progress-bar" min="0" max="100" value="100" step="33"
              aria-labelledby="form-progress-completion"></progress>

            <div class="justify-content-center d-flex align-items-center form-progress-indicator one active">1</div>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator two active">2</div>
            <div class="justify-content-center d-flex align-items-center form-progress-indicator three active">3</div>

            <p id="form-progress-completion" class="js-form-progress-completion sr-only" aria-live="polite">0% complete
            </p>
          </div>
        </div>
        <div class="form-outline mb-3">
          <div class="mb-3">
            <label class="form-label my-2 fw-bold">Time Limit</label>
            <div class="d-flex gap-3 align-items-center">
              <input id="quiz-time_limit" type="number" style="width: 150px; background-color: #f8f8f8;"
                class="form-control p-3 mb-2 border-0" placeholder="Time limit" required value="0" min="0" />
              <select id="quiz-time_limit_unit" class="form-select p-3 mb-2 border-0" style="width: 150px; background-color: #f8f8f8;"
                aria-label="Default select example">
                <option value="S">Second</option>
                <option value="M">Minutes</option>
                <option value="H">Hours</option>
                <option value="D">Days</option>
                <option value="W" selected>Weeks</option>
              </select>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="quiz-hide_time_display">
                <label class="form-check-label" for="quiz-hide_time_display">Hide quiz time - display</label>
              </div>
            </div>
            <small>Time limit for this quiz. 0 means no time limit.</small>
          </div>

          <div class="mb-3">
            <label class="form-label my-2 fw-bold">Quiz Feedback Mode</label><br>
            <div class="d-flex flex-column gap-3">
              <small>(Pick the quiz system"s behaviour on choice based questions.)</small>
              <div class="rounded border p-3">
                <div class="form-check d-flex gap-3 align-items-center">
                  <input class="form-check-input" type="radio" name="quiz-feedback_mode-js" id="quiz-defaultRadio" value="D" checked>
                  <div class="d-flex flex-column">
                    <label class="form-check-label" for="quiz-defaultRadio">
                      Default
                    </label>
                    <small class="text-muted">Answers shown after quiz is finished.</small>
                  </div>
                </div>
              </div>
              <div class="rounded border p-3">
                <div class="form-check d-flex gap-3 align-items-center">
                  <input class="form-check-input" type="radio" name="quiz-feedback_mode-js" id="quiz-revealModeRadio" value="R">
                  <div class="d-flex flex-column">
                    <label class="form-check-label" for="quiz-revealModeRadio">
                      Reveal Mode
                    </label>
                    <small class="text-muted">Show result after the attempt.</small>
                  </div>
                </div>
              </div>
              <div class="rounded border p-3">
                <div class="form-check d-flex gap-3 align-items-center">
                  <input class="form-check-input" type="radio" name="quiz-feedback_mode-js" id="quiz-retryModeRadio" value="T">
                  <div class="d-flex flex-column">
                    <label class="form-check-label" for="quiz-retryModeRadio">
                      Retry Mode
                    </label>
                    <small class="text-muted">Reattempt quiz any number of times. Define Attempts Allowed below.</small>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label my-2 fw-bold">Quiz Feedback Mode</label><br>
                <div class="d-flex gap-3 p-3 rounded border">
                  <input name="quiz-max_attempts_allowed-js" type="range" min="0" max="20" value="50" id="slider" style="width: 100%;">
                  <div class="rangePercentage d-flex flex-column align-items-center justify-content-center rounded-end">
                    <div class="arrow"></div>
                    <span class="percentage-label fw-bold" id="percentage-label">50</span>
                  </div>
                </div>
                <small>Restriction on the number of attempts a student is allowed to take for this quiz. 0
                  for no limit</small>
              </div>
              <div class="mb-3">
                <div class="form-outline">
                  <label class="form-label my-2 fw-bold">Passing Grade (%)</label>
                  <input id="quiz-passing_percentage" type="number" style="background-color: #f8f8f8;" name="title"
                    class="form-control p-3 mb-2 border-0" required value="80" min="0" max="100" />
                </div>
                <small>Set the passing percentage for this quiz</small>
              </div>
              <div class="mb-3">
                <div class="form-outline">
                  <label class="form-label my-2 fw-bold">Max Question Allowed to Answer</label>
                  <input id="quiz-max_questions" type="number" style="background-color: #f8f8f8;" name="title"
                    class="form-control p-3 mb-2 border-0" required value="1" min="1" />
                </div>
                <small>This amount of question will be available for students to answer, and question will comes
                  randomly from all available questions belongs with a quiz, if this amount is greater than available
                  question, then all questions will be available for a student to answer.</small>
              </div>
              <div class="mb-3">
                <div class="card bg-white text-start mb-3">
                  <div class="card-body p-0">
                    <div class="section px-2 py-3 d-flex align-items-center justify-content-between">
                      <div class="d-flex gap-2 align-items-center">
                        <button class="btn btn-outline-primary border rounded-circle" type="button"
                          style="background-color: rgb(209, 242, 255);" aria-expanded="false">
                          <i class="fas fa-cog text-primary"></i>
                        </button>
                        <span class="fw-bold text-muted">Advance Settings</span>
                      </div>
                      <span class="d-flex gap-2 px-2">
                        <button type="button" class="btn btn-sm" data-bs-toggle="collapse" href="#advanceSettings"><i
                            class="fas fa-chevron-down text-muted"></i></button>
                      </span>
                    </div>
                    <div class="collapse" id="advanceSettings">
                      <div class="card card-body">
                        <div class="mb-4">
                          <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="quiz-auto_start">
                            <label class="form-check-label" for="quiz-auto_start">Quiz Auto Start</label>
                          </div>
                          <small class="text-muted">If you enable this option, the quiz will start automatically after
                            the page is loaded.</small>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex gap-3 align-items-center">
                            <div style="width: 47%;">
                              <label class="form-label my-2 fw-bold">Question Layout</label>
                              <select class="form-select p-3 mb-2 border-0" style="background-color: #f8f8f8;"
                                aria-label="Default select example">
                                <option selected>Set Question Layout View</option>
                                <option>Single Question</option>
                                <option value="1">Question Pagination</option>
                                <option value="2">Question Below Each Other</option>
                              </select>
                            </div>
                            <div style="width: 47%;">
                              <label class="form-label my-2 fw-bold">Questions Order</label>
                              <select class="form-select p-3 mb-2 border-0" style="background-color: #f8f8f8;"
                                aria-label="Default select example">
                                <option selected>Random</option>
                                <option>Sorting</option>
                                <option value="1">Ascending</option>
                                <option value="2">Descending</option>
                              </select>
                            </div>
                          </div>
                          <small>Time limit for this quiz. 0 means no time limit.</small>
                        </div>
                        <div class="my-3">
                          <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="quiz-hide_question_no">
                            <label class="form-check-label" for="quiz-hide_question_no">Hide question number</label>
                          </div>
                          <small class="text-muted">Show/hide question number during attempt.</small>
                        </div>
                        <div class="mb-3">
                          <div class="form-outline">
                            <label class="form-label my-2 fw-bold">Short answer characters limit</label>
                            <input id="quiz-short_ans_char_limit" type="number" style="background-color: #f8f8f8;" name="title"
                              class="form-control p-3 mb-2 border-0" required value="200" min="0"/>
                          </div>
                          <small class="text-muted">Student will place answer in short answer question type within this
                            characters
                            limit.</small>
                        </div>
                        <div class="mb-3">
                          <div class="form-outline">
                            <label class="form-label my-2 fw-bold">Open-Ended/Essay questions answer character
                              limit</label>
                            <input id="quiz-long_ans_char_limit" type="number" style="background-color: #f8f8f8;" name="title"
                              class="form-control p-3 mb-2 border-0" required value="500" min="0" />
                          </div>
                          <small class="text-muted">Students will place the answer in the Open-Ended/Essay question type
                            within this
                            character limit.</small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Close</button>
        <div class="d-flex gap-3">
          <button type="button" data-bs-toggle="modal" data-bs-target="#quizModalStep2"
            class="btn btn-outline-primary">Back</button>
          <button id="save-quiz-step3" type="button" class="btn btn-primary">Save & Next</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>

  const questionTypes = {
    "TF": {
      "icon": "far fa-adjust",
      "title": "True / False",
      "color": "#3e64de",
      "code": "TF",
    },
    "SC": {
      "icon": "far fa-check",
      "title": "Single Choice",
      "color": "#00b890",
      "code": "SC",
    },
    "MC": {
      "icon": "far fa-check-double",
      "title": "Multiple Choice",
      "color": "#9034a9",
      "code": "MC",
    },
    "OE": {
      "icon": "far fa-text-width",
      "title": "Open Ended",
      "color": "#fe3129",
      "code": "OE",
    },
    "FB": {
      "icon": "far fa-hourglass-end",
      "title": "Fill In The Blanks",
      "color": "#ffbf00",
      "code": "FB",
    },
    "SA": {
      "icon": "far fa-compress",
      "title": "Short Answer",
      "color": "#f37512",
      "code": "SA",
    },
    "M": {
      "icon": "far fa-exchange-alt",
      "title": "Matching",
      "color": "#8a4a1b",
      "code": "M",
    },
    "IM": {
      "icon": "far fa-images",
      "title": "Image Matching",
      "color": "#f37512",
      "code": "IM",
    },
    "IA": {
      "icon": "fas fa-camera",
      "title": "Image Answering",
      "color": "#a322f9",
      "code": "IA",
    },
    "O": {
      "icon": "far fa-sort-alpha-up",
      "title": "Ordering",
      "color": "#1b52d8",
      "code": "O",
    },

  };  
  
  
  function selectQuestionType(questionType, context){
    const singleChoiceQuestionType = questionTypes[questionType];
    var newHtmlContent =
        `<div style="width: 200px; cursor: pointer;" data-question-type="${singleChoiceQuestionType.code}" class="questionTypeJS">
        <div class="d-flex gap-3 align-items-center">
          <button class="btn btn-outline-primary border rounded" type="button"
            style="background-color: ${singleChoiceQuestionType.color}; color: white;" aria-expanded="false">
            <i class="${singleChoiceQuestionType.icon}"></i>
          </button>
          <small class="fw-bold text-muted">${singleChoiceQuestionType.title}</small>
        </div>
      </div>`;

      $("#selectedTypeJS").html(newHtmlContent);
      showOptions(questionType, context);
  }



  const optionForm_trueFalse = function(context) {
    console.log("tf_correct_answer", context.tf_correct_answer)
   return `
   <div class="p-5" id="optionform_true_/_false" style="background: #e3e5eb;">
     <div class="bg-white border mb-3 p-3 rounded d-flex align-items-center justify-content-between">
       <small>
         True
       </small>
       <span class="d-flex gap-2 align-items-center">
         <div class="form-check">
           <input id="option-TF-true" class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="radio"
             name="trueFalse" value="true" ${context.tf_correct_answer ? "checked" : ""}>
         </div>
         <span class="fs-6 SortHandle" style="cursor: grab;">
           <i class="fal fa-grip-vertical text-muted mx-2"></i>
         </span>
       </span>
     </div>
     <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between">
       <small>
         False
       </small>
       <span class="d-flex gap-2 align-items-center">
         <div class="form-check">
           <input id="option-TF-false" class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="radio"
             name="trueFalse" value="false" ${context.tf_correct_answer ? "" : "checked"}>
         </div>
         <span class="fs-6 SortHandle" style="cursor: grab;">
           <i class="fal fa-grip-vertical text-muted mx-2"></i>
         </span>
       </span>
     </div>
   </div>
   `; 
  }

    const optionForm_singleChoice = function(context) {
      let string = `
      <div class="p-5" id="optionform_single_choice" style="background: #e3e5eb;">
        <div id="question-SC-option-container">
      `
      console.log("context", context)
      if (context.options_data) {
        context.options_data.forEach(function(op){
          string += `
          <div class="d-flex align-items-center mb-3 gap-3">
            <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
              style="width: 97%;">
              <small>
                ${op.title}
              </small>
              <span class="d-flex gap-2 align-items-center">
          `
                
          if (op.image) {
            string += `
                <div class="optionImage mx-2"
                  style="background-image: url('${op.image_data.file}');"></div>
            `
          }      
                  
          string +=`
                <div class="form-check">
                  <input class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="radio"
                    name="question-SC-option-is_correct-js" value="${op.id}" ${op.is_correct ? "checked" : ""}>
                </div>
                <button class="collapse-toggle-options-js fs-6 btn btn-outline-primary border rounded-circle" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#addOptionBtnJS" aria-expanded="false" data-option-id="${op.id}">
                    <i class="fal fa-pen"></i>
                </button>
                <span class="fs-6 SortHandle" style="cursor: grab;">
                  <i class="fal fa-grip-vertical text-muted mx-2"></i>
                </span>
              </span>
            </div>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="far fa-trash-alt text-muted"></i>
            </span>
          </div>
          `
        })
      }

      return string + `
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-light p-3 collapse-toggle-options-js" type="button" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button>
      </div>
      </div> <!-- end of question-SC-option-container -->
      <br>
      <div class="collapse" id="addOptionBtnJS">
        <div>
          <form id="question-SC-option-form">
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Answer title</label>
            <input id="question-SC-option-title" type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Title" required />
          </div>
          <label class="form-label my-2 fw-bold" style="font-size: 15px;">Upload Image</label>
          <div class="d-flex border rounded bg-white mb-3">
            <div class="p-3">
              <div class="d-none">
                <select id="question-option-image"></select>
              </div>
              <div class="thumbnail-preview" id="thumbnailPreview">
                <img id="question-option-image-preview" class="img-fluid" src="{% static 'images/thumbnail-placeholder.svg' %}" alt="thumbnail" />
              </div>
            </div>
            <div class="p-3 d-flex align-items-center" style="width: 100%">
              <span>
                <b id="imageDimensions">Allowed Size: 700x430 pixels</b>
                <p>File Support:</p>
                <button type="button" class="btn btn-primary" 
                  id="question-option-image-btn-js">
                    Upload Image
                </button>
              </span>
            </div>
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Display format for options</label>
            <div class="d-flex justify-content-around">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="question-SC-option-display_format" value="T" id="question-SC-option-onlyText" checked>
                <label class="form-check-label fw-bold" for="question-SC-option-onlyText">
                  Only Text
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="question-SC-option-display_format" value="I" id="question-SC-option-onlyImage">
                <label class="form-check-label fw-bold" for="question-SC-option-onlyImage">
                  Only Image
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="question-SC-option-display_format" value="B" id="question-SC-option-bothTextImage">
                <label class="form-check-label fw-bold" for="question-SC-option-bothTextImage">
                  Text & Image both
                </label>
              </div>
            </div>
            <button type="submit" class="btn btn-primary mt-5" form="question-SC-option-form">
              Update Answer
            </button>
          </div>
          </form>
        </div>
      </div>
    </div>
    `;
    }

    const optionForm_ordering = `
    <div class="p-5" id="optionform_single_choice" style="background: #e3e5eb;">
      <div class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            option 1
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      <div class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            option 2
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-light p-3" type="button" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button>
      </div>
      <br>
      <div class="collapse" id="addOptionBtnJS">
        <div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Answer title</label>
            <input type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
          </div>
          <label class="form-label my-2 fw-bold" style="font-size: 15px;">Upload Image</label>
          <div class="d-flex border rounded bg-white mb-3">
            <div class="p-3">
              <div class="thumbnail-preview" id="thumbnailPreview">
                <img class="img-fluid" src="{% static 'images/thumbnail-placeholder.svg' %}" alt="thumbnail" />
              </div>
            </div>
            <div class="p-3 d-flex align-items-center" style="width: 100%">
              <span>
                <b id="imageDimensions">Allowed Size: 700x430 pixels</b>
                <p>File Support:</p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#mediaModal">
                  Upload Image
                </button>
              </span>
            </div>
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Display format for options</label>
            <div class="d-flex justify-content-around">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="onlyText">
                <label class="form-check-label fw-bold" for="onlyText">
                  Only Text
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="onlyImage" checked>
                <label class="form-check-label fw-bold" for="onlyImage">
                  Only Image
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="bothTextImage" checked>
                <label class="form-check-label fw-bold" for="bothTextImage">
                  Text & Image both
                </label>
              </div>
            </div>
            <button type="button" class="btn btn-primary mt-5">
              Update Answer
            </button>
          </div>
        </div>
      </div>
    </div>
    `;

    const optionForm_multipleChoice = `
    <div class="p-5" id="optionform_multiple_choice" style="background: #e3e5eb;">
      <div class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            Choice 1
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <div class="form-check">
              <input class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="checkbox"
                value="choice1">
            </div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      <div class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            Choice 2
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <div class="form-check">
              <input class="form-check-input" style="border: 1px solid rgb(0, 119, 255);" type="checkbox"
                value="choice2">
            </div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-light p-3" type="button" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button>
      </div>
      <br>
      <div class="collapse" id="addOptionBtnJS">
        <div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Answer title</label>
            <input type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
          </div>
          <label class="form-label my-2 fw-bold" style="font-size: 15px;">Upload Image</label>
          <div class="d-flex border rounded bg-white mb-3">
            <div class="p-3">
              <div class="thumbnail-preview" id="thumbnailPreview">
                <img class="img-fluid" src="{% static 'images/thumbnail-placeholder.svg' %}" alt="thumbnail" />
              </div>
            </div>
            <div class="p-3 d-flex align-items-center" style="width: 100%">
              <span>
                <b id="imageDimensions">Allowed Size: 700x430 pixels</b>
                <p>File Support:</p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#mediaModal">
                  Upload Image
                </button>
              </span>
            </div>
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Display format for options</label>
            <div class="d-flex justify-content-around">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="onlyText">
                <label class="form-check-label fw-bold" for="onlyText">
                  Only Text
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="onlyImage" checked>
                <label class="form-check-label fw-bold" for="onlyImage">
                  Only Image
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="bothTextImage" checked>
                <label class="form-check-label fw-bold" for="bothTextImage">
                  Text & Image both
                </label>
              </div>
            </div>
            <button type="button" class="btn btn-primary mt-5">
              Update Answer
            </button>
          </div>
        </div>
      </div>
    </div>
    `;

    const optionForm_fillBlanks = function(context) {
      let string = `
      <div class="p-5" id="optionform_fill_in_the_blanks" style="background: #e3e5eb;">
        <div id="question-FB-option-container">
      `
      if (context.fb_question_title) {
        string += `
        <div class="bg-white border p-3 mb-3 gap-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small style="width: 100%;" class="text-muted d-flex justify-content-between">
            <div id="question-FB-question_title">${context.fb_question_title}</div>
            <div>
              Answer: <b id="question-FB-correct_answer">${context.fb_correct_answer}</b>
            </div>
          </small>
          <span class="d-flex gap-2 align-items-center">
            <button class="btn btn-outline-primary border rounded-circle" type="button"
            data-bs-toggle="collapse"
            data-bs-target="#addOptionBtnJS" aria-expanded="false">
              <i class="fal fa-pen"></i>
            </button>
          </span>
        </div>
      </div> <!-- end of question-FB-option-container -->
        `
      }
      else {
        string += `
        <button type="button" class="btn btn-light p-3 btn-block w-100" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button> 
        </div> <!-- end of question-FB-option-container -->
        `
      }
      return string + `
        <div class="collapse" id="addOptionBtnJS">
          <div>
            <form id="question-FB-option-form">
              <div class="form-outline mb-3">
                <label class="form-label my-2 fw-bold" style="font-size: 15px;">Question Title</label>
                <input id="question-FB-question_title-input" type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
                  placeholder="Title" value="${context.fb_question_title || ""}" required />
                <small class="text-muted">
                  <i class="fal fa-info-circle"></i> Please make sure to use the {dash} variable in your question title to show the blanks in your question. You can use multiple {dash} variables in one question.
                </small>
              </div>
              <div class="form-outline mb-3">
                <label class="form-label my-2 fw-bold" style="font-size: 15px;">Correct Answer(s)</label>
                <input id="question-FB-correct_answer-input" type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
                  placeholder="Answer" value="${context.fb_correct_answer || ""}" required />
                <small class="text-muted">
                  <i class="fal fa-info-circle"></i> Separate multiple answers by a vertical bar |. 1 answer per {dash} variable is defined in the question. Example: Apple | Banana | Orange
                </small>
              </div>
              <button type="submit" class="btn btn-primary mt-5">
                Update Answer
              </button>
            </form>
          </div>
        </div>
      </div>
      `;
    }

    const optionForm_default = `
    <div class="p-5" id="optionform_matching" style="background: #e3e5eb;">
      No option is necessary for this answer type
    </div>
    `;

    const optionForm_imageMatching = `
    <div class="p-5" id="optionform_image_matching" style="background: #e3e5eb;">
      <div class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            Image matching text
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-light p-3" type="button" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button>
      </div>
      <br>
      <div class="collapse" id="addOptionBtnJS">
        <div>
          <label class="form-label my-2 fw-bold" style="font-size: 15px;">Upload Image</label>
          <div class="d-flex border rounded bg-white mb-3">
            <div class="p-3">
              <div class="thumbnail-preview" id="thumbnailPreview">
                <img class="img-fluid" src="{% static 'images/thumbnail-placeholder.svg' %}" alt="thumbnail" />
              </div>
            </div>
            <div class="p-3 d-flex align-items-center" style="width: 100%">
              <span>
                <b id="imageDimensions">Allowed Size: 700x430 pixels</b>
                <p>File Support:</p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#mediaModal">
                  Upload Image
                </button>
              </span>
            </div>
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Image matched text</label>
            <input type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
          </div>
          <button type="button" class="btn btn-primary mt-5">
            Update Answer
          </button>
        </div>
      </div>
    </div>
    `;

    const optionForm_imageAnswering = `
    <div class="p-5" id="optionform_image_answering" style="background: #e3e5eb;">
      <div id="optionsList" class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            Image matching text
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-light p-3" type="button" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button>
      </div>
      <br>
      <div class="collapse" id="addOptionBtnJS">
        <div>
          <label class="form-label my-2 fw-bold" style="font-size: 15px;">Upload Image</label>
          <div class="d-flex border rounded bg-white mb-3">
            <div class="p-3">
              <div class="thumbnail-preview" id="thumbnailPreview">
                <img class="img-fluid" src="{% static 'images/thumbnail-placeholder.svg' %}" alt="thumbnail" />
              </div>
            </div>
            <div class="p-3 d-flex align-items-center" style="width: 100%">
              <span>
                <b id="imageDimensions">Allowed Size: 700x430 pixels</b>
                <p>File Support:</p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#mediaModal">
                  Upload Image
                </button>
              </span>
            </div>
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Answer input value</label>
            <input type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
            <small class="text-muted">
              <i class="fal fa-info-circle"></i> The answers that students enter should match with this text. Write in <b>small caps</b>
            </small>
          </div>
          <button type="button" class="btn btn-primary mt-5">
            Update Answer
          </button>
        </div>
      </div>
    </div>
    `;

    const optionForm_matching = `
    <div class="p-5" id="optionform_image_answering" style="background: #e3e5eb;">
      <div id="optionsList" class="d-flex align-items-center mb-3 gap-3">
        <div class="bg-white border p-3 rounded d-flex align-items-center justify-content-between"
          style="width: 97%;">
          <small>
            Answer title - Matched Answer title
          </small>
          <span class="d-flex gap-2 align-items-center">
            <div class="optionImage mx-2"
              style="background-image: url('https://images.unsplash.com/photo-1692651955510-8b334577cff7');"></div>
            <span class="fs-6">
              <i class="fal fa-pen text-muted mx-2"></i>
            </span>
            <span class="fs-6 SortHandle" style="cursor: grab;">
              <i class="fal fa-grip-vertical text-muted mx-2"></i>
            </span>
          </span>
        </div>
        <span class="fs-6 SortHandle" style="cursor: grab;">
          <i class="far fa-trash-alt text-muted"></i>
        </span>
      </div>
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-light p-3" type="button" data-bs-toggle="collapse"
          data-bs-target="#addOptionBtnJS" aria-expanded="false" aria-controls="addOptionBtnJS">Add an
          option</button>
      </div>
      <br>
      <div class="collapse" id="addOptionBtnJS">
        <div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Answer title</label>
            <input type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Matched Answer title</label>
            <input type="text" style="background-color: #f8f8f8;" class="form-control p-3 mb-2 border-0"
              placeholder="Quiz Title" required />
          </div>
          <label class="form-label my-2 fw-bold" style="font-size: 15px;">Upload Image</label>
          <div class="d-flex border rounded bg-white mb-3">
            <div class="p-3">
              <div class="thumbnail-preview" id="thumbnailPreview">
                <img class="img-fluid" src="{% static 'images/thumbnail-placeholder.svg' %}" alt="thumbnail" />
              </div>
            </div>
            <div class="p-3 d-flex align-items-center" style="width: 100%">
              <span>
                <b id="imageDimensions">Allowed Size: 700x430 pixels</b>
                <p>File Support:</p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#mediaModal">
                  Upload Image
                </button>
              </span>
            </div>
          </div>
          <div class="form-outline mb-3">
            <label class="form-label my-2 fw-bold" style="font-size: 15px;">Display format for options</label>
            <div class="d-flex justify-content-around">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="onlyText">
                <label class="form-check-label fw-bold" for="onlyText">
                  Only Text
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="onlyImage" checked>
                <label class="form-check-label fw-bold" for="onlyImage">
                  Only Image
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="bothTextImage" checked>
                <label class="form-check-label fw-bold" for="bothTextImage">
                  Text & Image both
                </label>
              </div>
            </div>
            <button type="button" class="btn btn-primary mt-5">
              Update Answer
            </button>
          </div>
        </div>
      </div>
    </div>
    `;

    activeOptionId = "";

    function showOptions(type, context) {


      correct_options_state = [];
      if (context.options_data) {
        for (let i = 0; i < context.options_data.length; i++) {
          if (context.options_data[i].is_correct){
            correct_options_state.push(context.options_data[i].id);
          }
        }

      }



      switch (type) {
        case "TF":
          $("#typeOptionsJS").html(optionForm_trueFalse(context));
          break;

        case "SC":
          $("#typeOptionsJS").html(optionForm_singleChoice(context));


          function fetchOptions() {
            fetchQuizQuestions(activeQuizId, function(){
              const question = questions_state.find(question => question.id == quizQuestionId);
              options_state = question.options_data;
              showOptions("SC", question);
            });
          }

          $("input[name='question-SC-option-is_correct-js']").on("change", function(){
            const correct_op = $("input[name='question-SC-option-is_correct-js']:checked").val();
            console.log("correct_op", correct_op)
            if (correct_op) {
              correct_options_state = [parseInt(correct_op)];
            }
            else {
              correct_options_state = [];
            }
          });


          $("#question-option-image-btn-js").click(function(){
            $("#mediaModal").attr("data-target", "option_image");
            $('#mediaModal').modal('show');
          });


          // Collapse event
          $('.collapse-toggle-options-js').on('click', function(event) {
            const button = event.currentTarget;
            const option_id = button.getAttribute("data-option-id");
            console.log("option_id, activeOptionId", option_id, activeOptionId)
            activeOptionId = option_id;
            const option = options_state.find(option => option.id == option_id);
            console.log("option", option)
            if (option){
                $("#question-SC-option-title").val(option.title);
                if (option.display_format == "T") {
                  $("#question-SC-option-onlyText").prop("checked", true);
                  $("#question-SC-option-onlyImage").prop("checked", false);
                  $("#question-SC-option-bothTextImage").prop("checked", false);
                }
                else if (option.display_format == "I") {
                  $("#question-SC-option-onlyText").prop("checked", false);
                  $("#question-SC-option-onlyImage").prop("checked", true);
                  $("#question-SC-option-bothTextImage").prop("checked", false);
                }
                else if (option.display_format == "B") {
                  $("#question-SC-option-onlyText").prop("checked", false);
                  $("#question-SC-option-onlyImage").prop("checked", false);
                  $("#question-SC-option-bothTextImage").prop("checked", true);
                }
                if (option.image){
                  var selectElement = $('#question-option-image');
                  selectElement.empty(); // Remove all child nodes
                  var newOption = $('<option>', {
                      value: option.image,
                      text: "",
                      selected: true // Set the selected attribute to keep it selected
                  });
                  selectElement.append(newOption);
                  $("#question-option-image-preview").attr("src", option.image_data.file);
                }
                else {
                  var selectElement = $('#question-option-image');
                  selectElement.empty(); // Remove all child nodes
                  $("#question-option-image-preview").attr("src", "{% static 'images/thumbnail-placeholder.svg' %}");
                }
              }
              else {
                $("#question-SC-option-title").val("");
                $("#question-SC-option-onlyText").prop("checked", true);
                $("#question-SC-option-onlyImage").prop("checked", false);
                $("#question-SC-option-bothTextImage").prop("checked", false);
                var selectElement = $('#question-option-image');
                selectElement.empty(); // Remove all child nodes
                $("#question-option-image-preview").attr("src", "{% static 'images/thumbnail-placeholder.svg' %}");
            }

            

          });

          $("#question-SC-option-form").submit(function(){
            event.preventDefault();
            let url = "";
            const option = options_state.find(option => option.id == activeOptionId);
            if (option) {
              url = "/courses/update-option/" + activeOptionId + "/";
            }
            else {
              url = "/courses/create-option/" + quizQuestionId + "/";
            }

            let data = {
              "type": "SC",
              "title": $("#question-SC-option-title").val(),
              "image": $("#question-option-image").val(),
              "display_format": $("input[name='question-SC-option-display_format']:checked").val(),
              "sort_order": option ? option.sort_order : null,
            }

            $.ajax({
              type: "POST",
              url: url,
              data: JSON.stringify(data),
              headers : { "X-CSRFToken": "{{ csrf_token }}" },
              success: function(response) {
                $("#addOptionBtnJS").collapse("hide");
                fetchOptions();
              },
              error: function(error) {
                console.log(error);
              }
            });



          });
          break;

        case "MC":
          $("#typeOptionsJS").html(optionForm_multipleChoice);
          break;

        case "FB":
          $("#typeOptionsJS").html(optionForm_fillBlanks(context));
          $("#question-FB-option-form").submit(function(){
            event.preventDefault();
            const question_title = $("#question-FB-question_title-input").val();
            const correct_answer = $("#question-FB-correct_answer-input").val();
            $("#question-FB-option-container").html(`
              <div class="bg-white border p-3 mb-3 gap-3 rounded d-flex align-items-center justify-content-between"
                style="width: 97%;">
                <small style="width: 100%;" class="text-muted d-flex justify-content-between">
                  <div id="question-FB-question_title">${question_title}</div>
                  <div>
                    Answer: <b id="question-FB-correct_answer">${correct_answer}</b>
                  </div>
                </small>
                <span class="d-flex gap-2 align-items-center">
                  <button class="btn btn-outline-primary border rounded-circle" type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#addOptionBtnJS" aria-expanded="false">
                    <i class="fal fa-pen"></i>
                  </button>
                </span>
              </div>
            `);
            $("#addOptionBtnJS").collapse("hide");
          });
          break;

        case "IM":
          $("#typeOptionsJS").html(optionForm_imageMatching);
          break;

        case "IA":
          $("#typeOptionsJS").html(optionForm_imageAnswering);
          break;

        case "O":
          $("#typeOptionsJS").html(optionForm_ordering);
          break;

        case "M":
          $("#typeOptionsJS").html(optionForm_matching);
          break;

        default:
          $("#typeOptionsJS").html(optionForm_default);
      }
    }



    



  const slider = document.getElementById("slider");
  const percentageLabel = document.getElementById("percentage-label");

  slider.addEventListener("input", () => {
    const value = slider.value;
    percentageLabel.textContent = value;
  });
</script>