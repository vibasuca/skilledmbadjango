{% extends "base.html" %}
{% load static my_extras %}
{% block title %}Skilled MBA{% endblock title %}

{% block content %}
<style>
    .instructor-image-grid {
        display: flex;
        flex-wrap: wrap;
        margin: -15px;
    }

    .instructor-image-grid-item {
        flex: 0 0 200px;
        position: relative;
        overflow: hidden;
        background-color: rgb(218, 218, 218);
        height: 250px;
        cursor: pointer;
        min-width: 150px;
        width: 100%;
    }

    .image-grid-item {
        flex: 0 0 250px;
        position: relative;
        overflow: hidden;
        background-color: rgb(218, 218, 218);
        height: 250px;
        cursor: pointer;
        min-width: 150px;
        width: 100%;
    }

    .instructor-image-grid-item::before,
    .image-grid-item::before {
        content: "";
        display: block;
        padding-bottom: 100%;
    }

    .instructor-image-background,
    .image-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
    }
</style>
<!--page title-->
<div class="container-fluid title-content">
    <div class="py-4" style="font-size: 14px;">
        <div class="container mt-2">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="{% url 'index' %}" class="hover-underline-animation">Home</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#" class="hover-underline-animation">Courses</a>
                    </li>
                    <li class="breadcrumb-item">{{course.title}}</li>
                </ol>
            </nav>
            <div class="p-lg-5">
                <h2>
                    {{course.title}}
                </h2>
                <div class="d-flex gap-3 align-items-center justify-content-start flex-wrap py-3">
                    <div class="d-flex gap-3 align-items-center justify-content-start">
                        <img src="{% if course.user.profile_pic %}{{ course.user.profile_pic.url }}{% else %}{% static 'images/profile-photo.png' %}{% endif %}"
                            alt="testi" style="width: 35px;" class="img-fluid rounded-circle">
                        <b>{{ course.user.get_full_name }}</b>
                    </div>
                    {% for instructor in course.instructors.all %}
                    <div class="d-flex gap-3 align-items-center justify-content-start">
                        <img src="{% if instructor.profile_pic %}{{ instructor.profile_pic.url }}{% else %}{% static 'images/profile-photo.png' %}{% endif %}"
                            alt="testi" style="width: 35px;" class="img-fluid rounded-circle">
                        <b>{{instructor.get_full_name}}</b>
                    </div>
                    {% endfor %}
                    <div class="d-flex gap-3 align-items-center justify-content-start">
                        Last Update {{course.updated_at|timesince}} ago
                    </div>
                </div>
                <div class="d-flex gap-3 align-items-center justify-content-start">
                    <span class="greet-text">
                        <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px;"></i>
                        <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px;"></i>
                        <i class="fas fa-star fa-sm" style="color: #c2c2c2; font-size: 14px;"></i>
                        <i class="fas fa-star fa-sm" style="color: #c2c2c2; font-size: 14px;"></i>
                        <i class="fas fa-star fa-sm" style="color: #c2c2c2; font-size: 14px;"></i>
                        <small>2 <span class="text-secondary">(1 ratings)</span></small>
                    </span>
                    <div>
                        {% if course.enrollments.all.count %}
                        {{course.enrollments.all.count}} already enrolled
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--main content-->
<div class="container-fluid bg-white">
    <div class="container py-4">
        <div class="row">
            <div class="col-lg-8 pt-3 p-lg-5">

                {% if enrollment %}
                <h5>Course Progress</h5>
                <div class="d-flex align-items-center gap-3 mt-4 mb-5">
                    <div class="progress flex-fill" role="progressbar" aria-label="course progress"
                        aria-valuenow="{{ enrollment.get_percentage_completed }}" aria-valuemin="0" aria-valuemax="100"
                        style="height: 10px;">
                        <div class="progress-bar" style="width: {{ enrollment.get_percentage_completed }}%;"></div>
                    </div>
                    <span class="text-muted text-center" style="width: auto;">{{ enrollment.get_percentage_completed }}
                        % Complete</span>
                </div>
                {% endif %}

                <h5 class="mb-4">Course Prerequisites</h5>
                <div class="alert alert-warning mb-4 d-flex gap-3">
                    <div><i class="fal fa-exclamation-triangle"></i></div>
                    <div>
                        Please note that this course has the following prerequisites which must be completed before it can be accessed
                    </div>
                </div>
                <div class="card mb-4">
                    <div class="card-body d-flex gap-3 align-items-center">
                        <div>
                            <img class="rounded" style="max-width: 100px;" src="https://placehold.co/600x400" alt="course prerequisite">
                        </div>
                        <span style="font-weight: 500;">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga culpa impedit consequuntur magni nesciunt eligendi!</span>
                    </div>
                </div>


                {% if course.description %}
                <h5>About This Course</h5>
                <div class="text-muted py-3" style="font-size: 15px;">
                    {{course.description|safe}}
                </div>
                {% endif %}
                {% if course.tags.all %}
                <!--tags-->
                <div>
                    <i class="far fa-tags text-muted"></i>&nbsp;&nbsp;
                    <b class="fw-bold text-muted">
                        {% for tag in course.tags.all %}
                        {{tag.title}}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </b>
                </div>
                {% endif %}

                {% if course.what_will_i_learn %}
                <!--Learning Objectives-->
                <div class="card my-5">
                    <div class="card-body p-4">
                        <h5>Learning Objectives</h5>
                        <div class="row text-muted" style="font-size: 15px;">
                            {% for line in course.get_what_will_i_learn_lines %}
                            {% if line %}
                            <div class="col-lg-6 p-3 d-flex gap-2">
                                <i class="fal text-success fa-check-circle"></i>
                                <span>{{line}}</span>
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endif %}

                {% if course.requirements %}
                <h5>Requirements</h5>
                <div class="text-muted py-3" style="font-size: 15px;">
                    {% for line in course.get_requirements_lines %}
                    {% if line %}
                    <div class="mb-3 d-flex gap-2">
                        <i class="far fa-check text-primary"></i>
                        <span>{{line}}</span>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endif %}

                <br>

                {% if course.target_audience %}
                <h5>Target Audience</h5>
                <div class="text-muted py-3" style="font-size: 15px;">
                    {% for line in course.get_target_audience_lines %}
                    {% if line %}
                    <div class="mb-3 d-flex gap-2">
                        <i class="far fa-long-arrow-right"></i>
                        <span>{{line}}</span>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endif %}
                <hr>
                <br>

                {% if course.topics.all %}
                <!--Curriculum-->
                <div class="mb-5">
                    <div class="d-flex justify-content-between">
                        <h5>Curriculum</h5>
                        <div class="d-flex gap-5 overflow-auto pb-3 ps-5" style="max-width: 50%; font-size: 14px;">
                            <span style="font-weight: 500;">{{course.get_lessons_count}}
                                Lesson{{course.get_lessons_count|pluralize:"s"}}</span>
                            <span>
                                {% if course.duration|get_timedelta_hours %}
                                {{course.duration|get_timedelta_hours}}h
                                {% endif %}
                                {% if course.duration|get_timedelta_minutes %}
                                {{course.duration|get_timedelta_minutes}}m
                                {% endif %}
                            </span>
                        </div>
                    </div>
                    <div class="my-3">
                        {% for topic in course.topics.all %}
                        <!--Topic card-->
                        <div class="card text-start mb-3">
                            <div class="card-body p-0">
                                <div class="section p-3 px-4 text-primary d-flex align-items-center gap-3"
                                    style="cursor: pointer;" data-bs-toggle="collapse"
                                    href="#topic-card{{forloop.counter}}">
                                    <i class="fas fa-plus"></i>
                                    <span style="font-weight: 500;">{{topic.title}}</span>
                                    <i class="fad fa-info-circle text-muted"></i>
                                </div>
                                <div class="collapse" id="topic-card{{forloop.counter}}">
                                    <div class="mt-0">
                                        <!--content in here-->
                                        <table class="table table-striped m-0">
                                            <tbody>
                                                {% for topic_item in topic.items.all %}
                                                <tr>
                                                    <td class="py-3 px-4 text-muted">
                                                        {% if topic_item.lesson %}
                                                        <i class="far fa-file-alt"></i>&nbsp;&nbsp;
                                                        {{topic_item.lesson.title}}
                                                        {% elif topic_item.assignment %}
                                                        <i class="far fa-file-edit"></i>&nbsp;&nbsp;
                                                        {{topic_item.assignment.title}}
                                                        {% elif topic_item.quiz %}
                                                        <i class="far fa-question-circle"></i>&nbsp;&nbsp;
                                                        {{topic_item.quiz.title}}
                                                        {% endif %}
                                                    </td>
                                                    {% if not topic_item.lesson.enable_preview %}
                                                    <td class="text-end py-3 px-4 text-muted"><i
                                                            class="far fa-lock-alt"></i>
                                                    </td>
                                                    {% endif %}
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                {% if course.attachments.all %}
                <!--Resources-->
                <div class="card border-0 mb-5">
                    <h5>Resources</h5>
                    <!--non-empty-->
                    <div class="row mt-4">
                        {% for attachment in course.attachments.all %}
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <div class="p-3" style="max-width: 90%;">
                                            <div class="text-truncate mb-2" style="max-width: 100%;">
                                                {{ attachment.file.url|get_filename }}
                                            </div>
                                            <small class="text-muted">Size: {{ attachment.get_size }}</small>
                                        </div>
                                        <a href="{{ attachment.file.url }}"
                                            download="{{ attachment.file.url|get_filename }}"
                                            class="btn btn-outline-primary border rounded-circle px-2 py-1"
                                            aria-expanded="false">
                                            <i class="fal fa-sm fa-cloud-download-alt"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                <!--Question & Answer-->
                <div class="mb-5">
                    <div class="d-flex align-items-center justify-content-between">
                        <h5>Question & Answer</h5>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#qaModal">
                            Ask a new question
                        </button>

                        <!-- Q&A Modal -->
                        <div class="modal fade" id="qaModal" tabindex="-1" aria-labelledby="qaModalLabel"
                            aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h1 class="modal-title fs-5" id="qaModalLabel">Ask a Question</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <textarea class="form-control" name="question" cols="30" rows="10"></textarea>
                                    </div>
                                    <div class="modal-footer d-flex gap-4 justify-content-center">
                                        <button type="button" class="btn btn-secondary"
                                            data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-primary">Post Question</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="my-4">
                        <!--Question 1-->
                        <div class="d-flex align-items-cente gap-3">
                            <div style="width: 50px; height: 50px; font-size: 25px; background: #f1f3f8;"
                                class="rounded-circle d-flex align-items-center justify-content-center text-primary">
                                <img src="https://placehold.co/35x35" alt="testi" style="width: 100%;"
                                    class="img-fluid rounded-circle">
                            </div>
                            <div class="d-flex flex-column gap-3" style="font-size: 14px; width: 100%;">
                                <div>
                                    <b>Om Dahale</b>
                                    <span class="text-muted">36 seconds ago</span>
                                </div>
                                <div class="p-3 rounded" style="background: #f8f8f8;">
                                    how to do this?
                                </div>
                                <!--Answer 1-->
                                <div class="d-flex align-items-cente gap-3">
                                    <div style="width: 50px; height: 50px; font-size: 25px; background: #f1f3f8;"
                                        class="rounded-circle d-flex align-items-center justify-content-center text-primary">
                                        <img src="https://placehold.co/35x35" alt="testi" style="width: 100%;"
                                            class="img-fluid rounded-circle">
                                    </div>
                                    <div class="d-flex flex-column gap-3" style="font-size: 14px; width: 100%;">
                                        <div>
                                            <b>Om Dahale</b>
                                            <span class="text-muted">36 seconds ago</span>
                                        </div>
                                        <div class="p-3 rounded" style="background: #f8f8f8;">
                                            how to do what?
                                        </div>
                                    </div>
                                </div>
                                <!--Answer 2-->
                                <div class="d-flex align-items-cente gap-3">
                                    <div style="width: 50px; height: 50px; font-size: 25px; background: #f1f3f8;"
                                        class="rounded-circle d-flex align-items-center justify-content-center text-primary">
                                        <img src="https://placehold.co/35x35" alt="testi" style="width: 100%;"
                                            class="img-fluid rounded-circle">
                                    </div>
                                    <div class="d-flex flex-column gap-3" style="font-size: 14px; width: 100%;">
                                        <div>
                                            <b>Om Dahale</b>
                                            <span class="text-muted">36 seconds ago</span>
                                        </div>
                                        <div class="p-3 rounded" style="background: #f8f8f8;">
                                            i don't know, ask the expert
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mt-4">
                                    <button class="btn btn-warning">Add an answer</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Instructors-->
                <div class="mb-5">
                    <h5>Your Instructors</h5>
                    <br>
                    <div class="card mb-4" style="max-width: 950px">
                        <div class="card-body">
                            <div class="d-flex flex-column flex-md-row">
                                <div class="instructor-image-grid-item rounded">
                                    <div class="instructor-image-background"
                                        style="background-image: url('{% if course.user.profile_pic %}{{ course.user.profile_pic.url }}{% else %}{% static 'images/profile-photo.png' %}{% endif %}')">
                                    </div>
                                </div>
                                <div class="px-md-3 py-lg-0 py-3 d-flex flex-wrap" style="width: 100%">
                                    <div style="width: 100%;">
                                        <div class="mb-2 d-flex flex-column gap-2">
                                            <span class="fw-bold">{{course.user.get_full_name}}</span>
                                            <small class="text-muted">{{course.user.job_title}}</small>
                                        </div>
                                        <div class="mb-2 d-flex flex-column">
                                            <span class="greet-text">
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fal fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <small class="text-muted" style="font-size: 15px">(2/5)</small>
                                            </span>
                                        </div>
                                        <small class="d-flex gap-3 my-2 text-muted"
                                            style="font-weight: 500; font-size: 13px;">
                                            <span><i
                                                    class="far fa-play-circle"></i>&nbsp;&nbsp;{{course.user.get_approved_course_count}}
                                                Course{{course.user.get_approved_course_count|pluralize:"s"}}</span>
                                            <span><i class="far fa-comment-alt"></i>&nbsp;&nbsp;3 Reviews</span>
                                            <span><i class="far fa-user"></i>&nbsp;&nbsp;78 Students</span>
                                        </small>
                                        <small>
                                            <span class="text-muted">{{course.user.bio}}</span>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% for instructor in course.instructors.all %}
                    <div class="card mb-4" style="max-width: 950px">
                        <div class="card-body">
                            <div class="d-flex flex-column flex-md-row">
                                <div class="instructor-image-grid-item rounded">
                                    <div class="instructor-image-background"
                                        style="background-image: url('{% if instructor.profile_pic %}{{ instructor.profile_pic.url }}{% else %}{% static 'images/profile-photo.png' %}{% endif %}')">
                                    </div>
                                </div>
                                <div class="px-md-3 py-lg-0 py-3 d-flex flex-wrap" style="width: 100%">
                                    <div style="width: 100%;">
                                        <div class="mb-2 d-flex flex-column gap-2">
                                            <span class="fw-bold">{{instructor.get_full_name}}</span>
                                            <small class="text-muted">{{instructor.job_title}}</small>
                                        </div>
                                        <div class="mb-2 d-flex flex-column">
                                            <span class="greet-text">
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fas fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <i class="fal fa-star fa-sm"
                                                    style="color: #ffa600; font-size: 14px"></i>
                                                <small class="text-muted" style="font-size: 15px">(2/5)</small>
                                            </span>
                                        </div>
                                        <small class="d-flex gap-3 my-2 text-muted"
                                            style="font-weight: 500; font-size: 13px;">
                                            <span><i
                                                    class="far fa-play-circle"></i>&nbsp;&nbsp;{{instructor.get_approved_course_count}}
                                                Course{{instructor.get_approved_course_count|pluralize:"s"}}</span>
                                            <span><i class="far fa-comment-alt"></i>&nbsp;&nbsp;3 Reviews</span>
                                            <span><i class="far fa-user"></i>&nbsp;&nbsp;78 Students</span>
                                        </small>
                                        <small>
                                            <span class="text-muted">{{instructor.bio}}</span>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <!--Announcements-->
                <div class="mb-5">
                    <h5>Announcements</h5>
                    {% for announcement in course.announcements.all %}
                    <div class="card mt-3">
                        <div class="card-body">
                            <div class="d-flex align-items-cente gap-3 gap-lg-4">
                                <div style="width: 50px; height: 50px; font-size: 25px; background: #f1f3f8;"
                                    class="rounded-circle d-flex align-items-center justify-content-center text-primary">
                                    <i class="far fa-bell"></i>
                                </div>
                                <div class="d-flex flex-column gap-2" style="font-size: 14px;">
                                    <b>{{announcement.title}}</b>
                                    <div class="text-muted">Posted by {{announcement.user.get_full_name}}
                                        {{announcement.created_at|timesince}} ago</div>
                                </div>
                            </div>
                            <div class="mt-4 text-muted" style="font-size: 14px;">
                                {{announcement.summary}}
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="card mt-3">
                        <div class="card-body">
                            <b>No announcements posted yet.</b>
                            <div class="mt-2 text-muted" style="font-size: 14px;">
                                The instructor hasn't added any announcements to this course yet. Announcements are used
                                to inform you of updates or additions to this course.
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <!--Student Feedback-->
                <div class="mb-5">
                    <h5>Student Feedback</h5>
                    <br>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card" style="height: 100%;">
                                <div
                                    class="card-body p-3 text-center d-flex justify-content-center align-items-center flex-column gap-2">
                                    <h1>4.5</h1>
                                    <div class="mb-2 d-flex flex-column">
                                        <span class="greet-text">
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                        </span>
                                    </div>
                                    <small class="text-muted">2 Ratings</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="mt-4 mt-lg-0 mb-2 d-flex flex-column d-flex flex-column gap-3">
                                <div class="d-flex align-items-center">
                                    <div class="p-2">
                                        <span>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                        </span>
                                    </div>
                                    <div class="p-2 d-flex align-items-center gap-3 flex-fill">
                                        <div class="progress" role="progressbar" aria-label="Basic example"
                                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"
                                            style="width: 100%; height: 10px;">
                                            <div class="progress-bar" style="width: 50%"></div>
                                        </div>
                                        50%
                                    </div>
                                </div>
                            </div>
                            <div class="mb-2 d-flex flex-column d-flex flex-column gap-3">
                                <div class="d-flex align-items-center">
                                    <div class="p-2">
                                        <span>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                        </span>
                                    </div>
                                    <div class="p-2 d-flex align-items-center gap-3 flex-fill">
                                        <div class="progress" role="progressbar" aria-label="Basic example"
                                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"
                                            style="width: 100%; height: 10px;">
                                            <div class="progress-bar" style="width: 40%"></div>
                                        </div>
                                        40%
                                    </div>
                                </div>
                            </div>
                            <div class="mb-2 d-flex flex-column d-flex flex-column gap-3">
                                <div class="d-flex align-items-center">
                                    <div class="p-2">
                                        <span>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                        </span>
                                    </div>
                                    <div class="p-2 d-flex align-items-center gap-3 flex-fill">
                                        <div class="progress" role="progressbar" aria-label="Basic example"
                                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"
                                            style="width: 100%; height: 10px;">
                                            <div class="progress-bar" style="width: 63%"></div>
                                        </div>
                                        63%
                                    </div>
                                </div>
                            </div>
                            <div class="mb-2 d-flex flex-column d-flex flex-column gap-3">
                                <div class="d-flex align-items-center">
                                    <div class="p-2">
                                        <span>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                        </span>
                                    </div>
                                    <div class="p-2 d-flex align-items-center gap-3 flex-fill">
                                        <div class="progress" role="progressbar" aria-label="Basic example"
                                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"
                                            style="width: 100%; height: 10px;">
                                            <div class="progress-bar" style="width: 50%"></div>
                                        </div>
                                        50%
                                    </div>
                                </div>
                            </div>
                            <div class="mb-2 d-flex flex-column d-flex flex-column gap-3">
                                <div class="d-flex align-items-center">
                                    <div class="p-2">
                                        <span>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                        </span>
                                    </div>
                                    <div class="p-2 d-flex align-items-center gap-3 flex-fill">
                                        <div class="progress" role="progressbar" aria-label="Basic example"
                                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"
                                            style="width: 100%; height: 10px;">
                                            <div class="progress-bar" style="width: 50%"></div>
                                        </div>
                                        50%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Write a review-->
                <div class="d-flex align-items-center justify-content-between">
                    <h5>Reviews (1)</h5>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reviewModal">
                        Write review
                    </button>
                    <!-- Review Modal -->
                    <div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="reviewModalLabel">Write review</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="mb-3 d-flex flex-column star-rating">
                                        <span class="greet-text">
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 25px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 25px"></i>
                                            <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 25px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 25px"></i>
                                            <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 25px"></i>
                                        </span>
                                    </div>
                                    <textarea class="form-control" name="question" cols="30" rows="10"></textarea>
                                </div>
                                <div class="modal-footer d-flex gap-4 justify-content-center">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Cancel</button>
                                    <button type="button" class="btn btn-primary">Post Review</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <!-- Reviews -->
                <div>
                    <div class="mb-5">
                        <div class="card-body">
                            <div class="d-flex align-items-cente gap-3 gap-lg-4">
                                <div style="width: 50px; height: 50px; font-size: 25px; background: #f1f3f8;"
                                    class="rounded-circle d-flex align-items-center justify-content-center text-primary">
                                    <img src="https://placehold.co/35x35" alt="testi" style="width: 100%;"
                                        class="img-fluid rounded-circle">
                                </div>
                                <div class="d-flex flex-column gap-2" style="font-size: 14px;">
                                    <b>Om Dahale</b>
                                    <div class="text-muted">8 mins ago</div>
                                </div>
                            </div>
                            <div class="my-2 d-flex flex-column">
                                <span class="greet-text">
                                    <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                    <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                    <i class="fas fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                    <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                    <i class="fal fa-star fa-sm" style="color: #ffa600; font-size: 14px"></i>
                                </span>
                            </div>
                            <div class="text-muted" style="font-size: 14px;">Thik thak laga ye course mujhe</div>
                        </div>
                    </div>
                    <div class="mb-5">
                        <div class="card-body">
                            <div class="d-flex align-items-cente gap-3 gap-lg-4">
                                <div style="width: 50px; height: 50px; font-size: 25px; background: #f1f3f8;"
                                    class="rounded-circle d-flex align-items-center justify-content-center text-primary">
                                    <img src="https://placehold.co/35x35" alt="testi" style="width: 100%;"
                                        class="img-fluid rounded-circle">
                                </div>
                                <div class="d-flex flex-column gap-2" style="font-size: 14px;">
                                    <b>Om Dahale</b>
                                    <div class="text-muted">8 mins ago</div>
                                </div>
                            </div>
                            <div class="my-2 d-flex flex-column">
                                <span class="greet-text">
                                    <i class="fas fa-star fa-sm"
                                        style="color: #ffa600; font-size: 14px; cursor: pointer;"></i>
                                    <i class="fas fa-star fa-sm"
                                        style="color: #ffa600; font-size: 14px; cursor: pointer;"></i>
                                    <i class="fas fa-star fa-sm"
                                        style="color: #ffa600; font-size: 14px; cursor: pointer;"></i>
                                    <i class="fal fa-star fa-sm"
                                        style="color: #ffa600; font-size: 14px; cursor: pointer;"></i>
                                    <i class="fal fa-star fa-sm"
                                        style="color: #ffa600; font-size: 14px; cursor: pointer;"></i>
                                </span>
                            </div>
                            <div class="text-muted" style="font-size: 14px;">Thik thak laga ye course mujhe</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Aside -->
            <div class="col-lg-4 pt-3">
                <div class="position-relative bg-white" id="courseSidePanelJS"
                    style="top: -275px !important; z-index: 1; transition: all 0.25s ease-in-out;">
                    <div class="card text-start bg-white mb-4">
                        <div class="image-grid-item rounded-top">
                            <div class="image-background"
                                style="background-image: url('{% if course.thumbnail %}{{course.thumbnail.file.url}}{% else %}{% static 'images/thumbnail-placeholder.svg' %}{% endif %}')">
                            </div>
                            {% comment %} <video class="image-background" src="https://placehold.co/1920x1080.mp4"
                                controls></video> {% endcomment %}
                        </div>
                        <div class="card-body tips p-4">
                            <h1 class="text-muted mb-4">
                                <b>
                                    {% if course.price %}
                                    {% if course.discount_price %}
                                    <span class="text-decoration-line-through">₹{{course.price}}</span>
                                    ₹{{course.discount_price}}
                                    {% else %}
                                    ₹{{course.price}}
                                    {% endif %}
                                    {% else %}
                                    Free
                                    {% endif %}
                                </b>
                            </h1>
                            <ul class="list-group list-group-flush" style="font-size: 14px;">
                                <li class="list-group-item px-0">
                                    <div class="d-flex align-items-center justify-content-between py-2">
                                        <div>
                                            <i class="far fa-sliders-h text-muted"></i>&nbsp;
                                            <b>Level</b>
                                        </div>
                                        <div>{{course.get_difficulty_level_display}}</div>
                                    </div>
                                </li>
                                {% if course.duration %}
                                <li class="list-group-item px-0">
                                    <div class="d-flex align-items-center justify-content-between py-2">
                                        <div>
                                            <i class="far fa-clock text-muted"></i>&nbsp;
                                            <b>Duration</b>
                                        </div>
                                        <div>
                                            {% if course.duration|get_timedelta_hours %}
                                            {{course.duration|get_timedelta_hours}}
                                            hour{{course.duration|get_timedelta_hours|pluralize:"s"}}
                                            {% endif %}
                                            {% if course.duration|get_timedelta_minutes %}
                                            {{course.duration|get_timedelta_minutes}}
                                            minute{{course.duration|get_timedelta_minutes|pluralize:"s"}}
                                            {% endif %}
                                        </div>
                                    </div>
                                </li>
                                {% endif %}
                                <li class="list-group-item px-0">
                                    <div class="d-flex align-items-center justify-content-between py-2">
                                        <div>
                                            <i class="far fa-play-circle text-muted"></i>&nbsp;
                                            <b>Lectures</b>
                                        </div>
                                        <div>{{course.get_lessons_count}}
                                            lecture{{course.get_lessons_count|pluralize:"s"}}</div>
                                    </div>
                                </li>
                                {% comment %}
                                <li class="list-group-item px-0">
                                    <div class="d-flex align-items-center justify-content-between py-2">
                                        <div>
                                            <i class="far fa-tag text-muted"></i>&nbsp;
                                            <b>Subject</b>
                                        </div>
                                        <div>Design Tools</div>
                                    </div>
                                </li>
                                {% endcomment %}
                                <li class="list-group-item px-0">
                                    <div class="d-flex align-items-center justify-content-between py-2">
                                        <div>
                                            <i class="far fa-globe text-muted"></i>&nbsp;
                                            <b>Langauge</b>
                                        </div>
                                        <div>{{course.get_language_display}}</div>
                                    </div>
                                </li>
                            </ul>
                            <br>

                            {% if course.materials_included %}
                            <h5>Material Includes</h5>
                            <div class="text-muted py-3" style="font-size: 15px;">
                                {% for line in course.get_materials_included_lines %}
                                {% if line %}
                                <div class="mb-3 d-flex gap-2">
                                    <i class="far fa-long-arrow-right text-primary"></i>
                                    <span>{{line}}</span>
                                </div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            {% endif %}

                            <div class="card-body d-flex flex-column align-items-center gap-3">
                                <div style="width: 100%;">
                                    <div class="d-grid gap-2">
                                        {% if enrollment %}
                                        <a href="{% url 'course_lesson' %}" class="btn btn-primary py-3"
                                            style="background: #0071dc;">
                                            <b>Continue to Lesson</b>
                                        </a>
                                        {% else %}
                                        <form id="enroll-form" method="POST"
                                            action="{% url 'courses:enroll_course' course.pk %}">
                                            {% csrf_token %}
                                        </form>
                                        <button class="btn btn-primary py-3" type="submit" form="enroll-form"
                                            style="background: #0071dc;">
                                            <b>Enroll Now</b>
                                        </button>
                                        {% endif %}
                                    </div>
                                </div>
                                <div style="width: 100%;">
                                    <div class="d-grid gap-2">
                                        <a href="#" class="btn py-3 btn-light text-primary" type="button">
                                            <b>Add to wishlist</b>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-center gap-4">
                                <div class="d-flex gap-4">
                                    <div>
                                        <a class="text-muted fs-4" href="#"><b>𝕏</b> </a>
                                    </div>
                                    <div>
                                        <a class="text-muted fs-4" href="#"><i class="fab fa-facebook"></i></a>
                                    </div>
                                    <div>
                                        <a class="text-muted fs-4" href="#"><i class="fab fa-tumblr"></i></a>
                                    </div>
                                    <div>
                                        <a class="text-muted fs-4" href="#"><i class="fab fa-linkedin"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if course.categories.all %}
                    <div class="card bg-white mb-4">
                        <div class="card-body p-4">
                            <h5>Course categories</h5>
                            <div class="d-flex flex-column gap-4">
                                <ul class="list-group">
                                    {% for cat in course.categories.all %}
                                    <li class="list-group-item border-0 px-0 text-muted"
                                        style="font-size: 16px; font-weight: 500;">{{cat.title}}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% if related_courses %}
                    <div class="card bg-white mb-4">
                        <div class="card-body p-4">
                            <h5>Related Courses</h5>
                            <br>
                            <ul class="list-group list-group-flush">
                                {% for rel_course in related_courses %}
                                <li class="list-group-item px-0">
                                    <div class="card border-0" style="max-width: 950px">
                                        <div class="card-body p-0">
                                            <div class="d-flex flex-column flex-md-row">
                                                <div class="instructor-image-grid-item rounded" style="height: 120px;">
                                                    <a href="{% url 'courses:course_details' rel_course.pk rel_course.slug %}"
                                                        class="text-dark">
                                                        <div class="image-background"
                                                            style="background-image: url('{% if rel_course.thumbnail %}{{ rel_course.thumbnail.file.url }}{% else %}{% static 'images/thumbnail-placeholder.svg' %}{% endif %}');">
                                                            <div class="position-absolute p-2" style="top: 0px;">
                                                                <span class="badge"
                                                                    style="background: #0071dc;">-15%</span>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                                <div class="px-md-3 py-lg-0 py-3 d-flex flex-wrap" style="width: 100%">
                                                    <div style="width: 100%;">
                                                        <div class="mb-2 d-flex flex-column gap-2">
                                                            <small class="fw-bold">{{rel_course.title}}</small>
                                                            <div class="text-muted">
                                                                {% if rel_course.price %}
                                                                {% if rel_course.discount_price %}
                                                                <b
                                                                    class="fs-5">₹{{rel_course.discount_price|get_price_whole}}</b><b>.{{rel_course.discount_price|get_price_fraction}}</b>
                                                                <s
                                                                    class="text-muted">₹{{rel_course.price|get_price_whole}}</s>
                                                                <s
                                                                    class="text-muted">.{{rel_course.price|get_price_fraction}}</s>
                                                                {% else %}
                                                                <b
                                                                    class="fs-5">₹{{rel_course.price|get_price_whole}}</b><b>.{{rel_course.price|get_price_fraction}}</b>
                                                                {% endif %}
                                                                {% else %}
                                                                <b class="fs-5">Free</b>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>


{% include 'loginPopup.html' %}

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    if (document.querySelector('.trigger') != null) {
        (new IntersectionObserver(function (e, o) {
            if (e[0].intersectionRatio > 0) {
                $("#courseSidePanelJS").removeClass("sticky-top").addClass("position-relative");
                $("#courseSidePanelJS").css("top", "-275px");
            } else {
                $("#courseSidePanelJS").removeClass("position-relative").addClass("sticky-top");
                $("#courseSidePanelJS").css("top", "175px");
            };

        })).observe(document.querySelector('.trigger'));
    }

    document.addEventListener("DOMContentLoaded", function () {
        var animateElements = document.querySelectorAll(".animate-me");

        function checkAnimation() {
            animateElements.forEach(function (element) {
                var elementPosition = element.getBoundingClientRect().top;
                var windowHeight = window.innerHeight;

                if (elementPosition < windowHeight - 100) { // Adjust threshold as needed
                    element.classList.add("animate");
                }
            });
        }

        window.addEventListener("scroll", checkAnimation);
        checkAnimation(); // Check on page load
    });

    $(document).ready(function () {
        $("#close-login-cta").click(function () {
            $(".login-cta").hide();
        });
    });

    $(".section").click(function () {
        $(this).children(".fas").toggleClass("fa-plus fa-minus");
    });

    $(document).ready(function () {
        $(".star-rating i").on("mouseover", function () {
            var allStars = $(this).parent().find("i.fa-star");
            var hoveredIndex = allStars.index($(this));
            allStars.each(function (index) {
                if (index <= hoveredIndex) {
                    $(this).removeClass("fal").addClass("fas");
                } else {
                    $(this).removeClass("fas").addClass("fal");
                }
            });

            var clicked = false;

            $(this).on("click", function () {
                clicked = true;
                $(this).parent().data("rated", hoveredIndex + 1);
            });

            $(this).on("mouseleave", function () {
                if (!clicked) {
                    var rated = $(this).parent().data("rated");
                    if (rated) {
                        allStars.each(function (index) {
                            if (index < rated) {
                                $(this).removeClass("fal").addClass("fas");
                            } else {
                                $(this).removeClass("fas").addClass("fal");
                            }
                        });
                    } else {
                        allStars.removeClass("fas").addClass("fal");
                    }
                }
            });
        });
    });

</script>

{% endblock content %}